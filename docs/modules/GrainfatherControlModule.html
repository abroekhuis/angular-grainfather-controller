<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>gf-ble documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">gf-ble documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content module">
                   <div class="content-data">



<ol class="breadcrumb">
    <li>Modules</li>
    <li>GrainfatherControlModule</li>
</ol>


<ul class="nav nav-tabs" role="tablist">
    <li  class="active" >
        <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
    </li>
    <li >
        <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
    </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">

        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts</code>
        </p>


        <p class="comment">
            <h3>Description</h3>
        </p>
        <p class="comment">
            <p>BLE controller. Takes care of setting up a Ble connection by asking the user for a device to connect to.</p>
<p>Monitors the connection, tries to reconnect if the connection is lost.</p>
<p>Todo: send events for connection status, to be able to show connection status and interrupt reconnect</p>

        </p>


        <div class="container-fluid module">
            <div class="row">
            </div>
        </div>

        <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="connect"></a>
                    <span class="name">
                        <b>
                            connect
                        </b>
                        <a href="#connect"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>connect()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="59"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:59</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Creates a new connection to a controller.</p>
<p>Show a popup to select a controller. After selecting a connection will be created by the &#39;reconnect&#39; method.</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="disconnect"></a>
                    <span class="name">
                        <b>
                            disconnect
                        </b>
                        <a href="#disconnect"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>disconnect()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="82"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:82</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Disconnects the connected device.</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getConnectionState"></a>
                    <span class="name">
                        <b>
                            getConnectionState
                        </b>
                        <a href="#getConnectionState"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getConnectionState()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="148"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:148</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Retrieves the connected status.</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../miscellaneous/enumerations.html#ConnectionState" target="_self" >ConnectionState</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="handleNotifications"></a>
                    <span class="name">
                        <b>
                            handleNotifications
                        </b>
                        <a href="#handleNotifications"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>handleNotifications(event: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="171"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:171</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Callback to handle notifications.</p>
<p>Notifications are forwarded to the &#39;GrainFatherNotifications&#39; for processing.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>event</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>notification</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="onDisconnected"></a>
                    <span class="name">
                        <b>
                            onDisconnected
                        </b>
                        <a href="#onDisconnected"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>onDisconnected(_: <a href="https://angular.io/api/router/Event" target="_blank">Event</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="133"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:133</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Handler for the disconnect event.</p>
<p>Will try to reconnect using the &#39;reconnect&#39; method.</p>
<p>Can be interrupted by calling the &#39;disconnect&#39; method.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>_</td>
                                    <td>
                                                <code><a href="https://angular.io/api/router/Event" target="_blank" >Event</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>unused event</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="reconnect"></a>
                    <span class="name">
                        <b>
                            reconnect
                        </b>
                        <a href="#reconnect"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>reconnect(device: BluetoothDevice)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="100"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:100</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>(Re)connects the given device.</p>
<p>Gets the primary service and needed characteristic to be able to send commands and receive notifications.</p>
<p>After successful connection, the connected state is set, and the current boil temperature is received (for later usage).</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>device</td>
                                    <td>
                                            <code>BluetoothDevice</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>the device to connect to, previously selected by the user</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="sendCommand"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Async</span>
                            sendCommand
                        </b>
                        <a href="#sendCommand"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>sendCommand(gfBleCommand: <a href="../classes/GrainFatherCommands.html">GrainFatherCommands</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="182"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:182</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Sends the given list of commands to the controller.
A delay between sending commands is needed, else the controller will misbehave.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>gfBleCommand</td>
                                    <td>
                                                <code><a href="../classes/GrainFatherCommands.html" target="_self" >GrainFatherCommands</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>the command to send.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="setConnectionState"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            setConnectionState
                        </b>
                        <a href="#setConnectionState"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>setConnectionState(state: <a href="../undefineds/ConnectionState.html">ConnectionState</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="206"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:206</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Set the connectioon state.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>state</td>
                                    <td>
                                                <code><a href="../miscellaneous/enumerations.html#ConnectionState" target="_self" >ConnectionState</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>new state</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="setRecipeDetails"></a>
                    <span class="name">
                        <b>
                            setRecipeDetails
                        </b>
                        <a href="#setRecipeDetails"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>setRecipeDetails(recipeDetails: <a href="../classes/RecipeDetails.html">RecipeDetails</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="218"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:218</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Status information from the controller is not enough to determinate the progress.
Recipe details are needed.</p>
<p>If a session is in progress, this information is needed to be able to determine the correct state.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>recipeDetails</td>
                                    <td>
                                                <code><a href="../classes/RecipeDetails.html" target="_self" >RecipeDetails</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>details of the current brewing session.</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="setupListener"></a>
                    <span class="name">
                        <b>
                            setupListener
                        </b>
                        <a href="#setupListener"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>setupListener(characteristic: BluetoothRemoteGATTCharacteristic)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="157"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:157</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Sets up the listener for notifications.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>characteristic</td>
                                    <td>
                                            <code>BluetoothRemoteGATTCharacteristic</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>notification characteristic</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="subscribeToConnectionStatus"></a>
                    <span class="name">
                        <b>
                            subscribeToConnectionStatus
                        </b>
                        <a href="#subscribeToConnectionStatus"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>subscribeToConnectionStatus(generatorOrNext?: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, error?: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, complete?: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="245"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:245</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Subscribe to connection status.</p>
<p>See &#39;ConnectionState&#39;</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>generatorOrNext</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                </tr>
                                <tr>
                                    <td>error</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                </tr>
                                <tr>
                                    <td>complete</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="subscribeToControllerStatus"></a>
                    <span class="name">
                        <b>
                            subscribeToControllerStatus
                        </b>
                        <a href="#subscribeToControllerStatus"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>subscribeToControllerStatus(generatorOrNext?: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, error?: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, complete?: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="236"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:236</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Subscribe to controller status.</p>
<p>See CStatus, FStatus, IStatus, TStatus, VStatus, WStatus, XStatus, YStatus</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>generatorOrNext</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                </tr>
                                <tr>
                                    <td>error</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                </tr>
                                <tr>
                                    <td>complete</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="subscribeToSessionStatus"></a>
                    <span class="name">
                        <b>
                            subscribeToSessionStatus
                        </b>
                        <a href="#subscribeToSessionStatus"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>subscribeToSessionStatus(generatorOrNext?: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, error?: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>, complete?: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="227"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:227</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Subscribe to session status.</p>
<p>See &#39;BrewingSessionState&#39;.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>generatorOrNext</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                </tr>
                                <tr>
                                    <td>error</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                </tr>
                                <tr>
                                    <td>complete</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="wait"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            wait
                        </b>
                        <a href="#wait"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>wait(timeout)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="195"
                            class="link-to-prism">projects/angular-grainfather-control/src/lib/angular-grainfather-control.module.ts:195</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Helper method to be able to set a delay between sending command lines.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>timeout</td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>time to wait</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">// Copyright [2020] [Alexander Broekhuis - a.broekhuis@gmail.com]
//
// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
// you may not use this file except in compliance with the License.
//   You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import {EventEmitter, NgModule, Output} from &#x27;@angular/core&#x27;;
import {BluetoothDevice, BluetoothRemoteGATTCharacteristic, BluetoothRemoteGATTServer, RequestDeviceOptions} from &#x27;web-bluetooth&#x27;;
import {interval} from &#x27;rxjs&#x27;;
import {GrainFatherNotifications} from &#x27;./grainfather.notifications&#x27;;
import {GrainFatherCommands, RecipeDetails} from &#x27;./grainfather.commands&#x27;;

export enum ConnectionState {
  Connecting,
  Reconnecting,
  Connected,
  Disconnected
}

/**
 * BLE controller. Takes care of setting up a Ble connection by asking the user for a device to connect to.
 *
 * Monitors the connection, tries to reconnect if the connection is lost.
 *
 * Todo: send events for connection status, to be able to show connection status and interrupt reconnect
 */
@NgModule({
  imports: [],
})
export class GrainfatherControlModule {
  GF_BLE_SERVICE &#x3D; &#x27;0000cdd0-0000-1000-8000-00805f9b34fb&#x27;;
  GF_BLE_READ_CHARACTERISTIC &#x3D; &#x27;0003cdd1-0000-1000-8000-00805f9b0131&#x27;;
  GF_BLE_WRITE_CHARACTERISTIC &#x3D; &#x27;0003cdd2-0000-1000-8000-00805f9b0131&#x27;;

  @Output()
  private connectionStatus: EventEmitter&lt;ConnectionState&gt; &#x3D; new EventEmitter&lt;ConnectionState&gt;();

  private device: BluetoothDevice;
  private server: BluetoothRemoteGATTServer;
  private writer: BluetoothRemoteGATTCharacteristic;

  private notificationHandler: GrainFatherNotifications &#x3D; new GrainFatherNotifications();

  private connectionState: ConnectionState &#x3D; ConnectionState.Disconnected;

  /**
   * Creates a new connection to a controller.
   *
   * Show a popup to select a controller. After selecting a connection will be created by the &#x27;reconnect&#x27; method.
   */
  connect(): Promise&lt;void&gt; {
    this.setConnectionState(ConnectionState.Connecting);
    // Setup filter for GF controller
    const options &#x3D; {
      filters: [{ services: [ this.GF_BLE_SERVICE ]}]
    } as RequestDeviceOptions;
    // Strange hack to get to navigator.bluetooth
    const navigator: any &#x3D; window.navigator;
    // Start connection setup by requesting a device
    return navigator.bluetooth.requestDevice(options)
      .then(device &#x3D;&gt; {
        this.device &#x3D; device;
        // Add a listener to get info on disconnect events
        device.addEventListener(&#x27;gattserverdisconnected&#x27;, this.onDisconnected.bind(this));
        // Use selected device to setup a connection
        return this.reconnect(device);
      }).catch(error &#x3D;&gt; console.log(error));
  }


  /**
   * Disconnects the connected device.
   */
  disconnect() {
    if (this.device.gatt.connected) {
      this.device.gatt.disconnect();
    }
    this.setConnectionState(ConnectionState.Disconnected);
    this.device &#x3D; null;
    this.server &#x3D; null;
  }

  /**
   * (Re)connects the given device.
   *
   * Gets the primary service and needed characteristic to be able to send commands and receive notifications.
   *
   * After successful connection, the connected state is set, and the current boil temperature is received (for later usage).
   *
   * @param device the device to connect to, previously selected by the user
   */
  reconnect(device: BluetoothDevice) {
    const self &#x3D; this;
    return device.gatt.connect().then(server &#x3D;&gt; {
      self.server &#x3D; server;
      return server.getPrimaryService(self.GF_BLE_SERVICE);
    }).then(service &#x3D;&gt; {
      return Promise.all([
        service.getCharacteristic(self.GF_BLE_READ_CHARACTERISTIC).then(characteristic &#x3D;&gt; {
          return self.setupListener(characteristic);
        }),
        service.getCharacteristic(self.GF_BLE_WRITE_CHARACTERISTIC).then(characteristic &#x3D;&gt; {
          self.writer &#x3D; characteristic;
        }),
      ]);
    }).then(_ &#x3D;&gt; {
      self.setConnectionState(ConnectionState.Connected);
      return self.sendCommand(GrainFatherCommands.createGetCurrentBoilTemperature());
    }).then(_ &#x3D;&gt; {
      self.notificationHandler.commandEmitter.subscribe(command &#x3D;&gt; {
        return self.sendCommand(command);
      });
    });
  }

  /**
   * Handler for the disconnect event.
   *
   * Will try to reconnect using the &#x27;reconnect&#x27; method.
   *
   * Can be interrupted by calling the &#x27;disconnect&#x27; method.
   *
   * @param _ unused event
   */
  onDisconnected(_: Event) {
    this.setConnectionState(ConnectionState.Reconnecting);

    const sub &#x3D; interval(5000).subscribe(() &#x3D;&gt; {
      if (this.device &amp;&amp; !this.device.gatt.connected) {
        this.reconnect(this.device);
      } else {
        sub.unsubscribe();
      }
    });
  }

  /**
   * Retrieves the connected status.
   */
  getConnectionState() {
    return this.connectionState;
  }

  /**
   * Sets up the listener for notifications.
   *
   * @param characteristic notification characteristic
   */
  setupListener(characteristic: BluetoothRemoteGATTCharacteristic) {
    return characteristic.startNotifications()
      .then(_ &#x3D;&gt; {
        characteristic.addEventListener(&#x27;characteristicvaluechanged&#x27;, this.handleNotifications.bind(this));
      }).catch(error &#x3D;&gt; console.log((error)));
  }

  /**
   * Callback to handle notifications.
   *
   * Notifications are forwarded to the &#x27;GrainFatherNotifications&#x27; for processing.
   *
   * @param event notification
   */
  handleNotifications(event: any) {
    const msg: string &#x3D; String.fromCharCode.apply(null, new Uint8Array(event.target.value.buffer));
    this.notificationHandler.process(msg);
  }

  /**
   * Sends the given list of commands to the controller.
   * A delay between sending commands is needed, else the controller will misbehave.
   *
   * @param gfBleCommand the command to send.
   */
  async sendCommand(gfBleCommand: GrainFatherCommands) {
    const commands &#x3D; gfBleCommand.encode();
    for (const command of commands) {
      await this.writer.writeValue(command);
      await this.wait(250);
    }
  }

  /**
   * Helper method to be able to set a delay between sending command lines.
   *
   * @param timeout time to wait
   */
  private wait(timeout) {
    return new Promise(resolve &#x3D;&gt; {
      setTimeout(resolve, timeout);
    });
  }

  /**
   * Set the connectioon state.
   *
   * @param state new state
   */
  private setConnectionState(state: ConnectionState) {
    this.connectionState &#x3D; state;
  }

  /**
   * Status information from the controller is not enough to determinate the progress.
   * Recipe details are needed.
   *
   * If a session is in progress, this information is needed to be able to determine the correct state.
   *
   * @param recipeDetails details of the current brewing session.
   */
  setRecipeDetails(recipeDetails: RecipeDetails) {
    this.notificationHandler.setRecipeDetails(recipeDetails);
  }

  /**
   * Subscribe to session status.
   *
   * See &#x27;BrewingSessionState&#x27;.
   */
  subscribeToSessionStatus(generatorOrNext?: any, error?: any, complete?: any) {
    return this.notificationHandler.sessionStatus.subscribe(generatorOrNext, error, complete);
  }

  /**
   * Subscribe to controller status.
   *
   * See CStatus, FStatus, IStatus, TStatus, VStatus, WStatus, XStatus, YStatus
   */
  subscribeToControllerStatus(generatorOrNext?: any, error?: any, complete?: any) {
    return this.notificationHandler.controllerStatus.subscribe(generatorOrNext, error, complete);
  }

  /**
   * Subscribe to connection status.
   *
   * See &#x27;ConnectionState&#x27;
   */
  subscribeToConnectionStatus(generatorOrNext?: any, error?: any, complete?: any) {
    return this.connectionStatus.subscribe(generatorOrNext, error, complete);
  }
}
</code></pre>
    </div>
</div>










                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'module';
            var COMPODOC_CURRENT_PAGE_URL = 'GrainfatherControlModule.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
